function [f,g,H] = get_equal_opposite_side(x)
n = size(x,1);
f = 0.5*((x(:,2)-x(:,1)-(x(:,4)-x(:,3))).^2+((1+x(:,1)-x(:,4))-(x(:,3)-x(:,2))).^2);
if nargout>1
    g = zeros(n,4);
g(:,1) = (-(x(:,2)-x(:,1)-(x(:,4)-x(:,3)))+((1+x(:,1)-x(:,4))-(x(:,3)-x(:,2))));
g(:,2) = ( (x(:,2)-x(:,1)-(x(:,4)-x(:,3)))+((1+x(:,1)-x(:,4))-(x(:,3)-x(:,2))));
g(:,3) = ( (x(:,2)-x(:,1)-(x(:,4)-x(:,3)))-((1+x(:,1)-x(:,4))-(x(:,3)-x(:,2))));
g(:,4) = (-(x(:,2)-x(:,1)-(x(:,4)-x(:,3)))-((1+x(:,1)-x(:,4))-(x(:,3)-x(:,2))));
end
if nargout>2
H = 0.5* [[4,	0,	-4,	0];...
		[0,	4,	0,	-4];...
		[-4,	0,	4,	0];...
		[0,	-4,	0,	4]...
	];
end
end